<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Promesas y asincronias</title>
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <h1 class="Titulo" onclick="location.href='index.html'">Promesas y Asincronía</h1>
    <div class="navegacion-izq">
        <button onclick="location.href='3-Arreglos.html'" ;>Arreglos en JavaScript</button>
    </div>
    <div class="navegacion-der">
        <button onclick="location.href='5-Módulos en JavaScript.html'">Módulos en JavaScript</button>
    </div>

    <div class="tarjeta">
        <div class="contenido">
            <div class="ladoIzq">
                <h2 class="titulo">Callbacks</h2>
                <div class="cuerpo">
                    <p>Un callback en JavaScript es una función que se pasa como argumento a otra función y se
                        ejecuta después de que se completa la tarea de la función que la recibió. Los callbacks son
                        una parte fundamental de la programación asíncrona en JavaScript, permitiendo que el
                        código continúe ejecutándose mientras se espera que se completen operaciones como
                        solicitudes de red o temporizadores
                    </p>
                    <p>Ejemplo de un callback simple:</p>
                    <script>
                        // Definimos una función que realiza la suma
                        function sumar(a, b, callback) {
                            const resultado = a + b; // Realiza la suma
                            callback(resultado); // Llama al callback con el resultado
                        }
                        // Definimos un callback que maneja el resultado
                        function mostrarResultado(resultado) {
                            document.write("La suma es: ", resultado);
                        }
                        // Llamamos a la función sumar y pasamos los números y el callback
                        sumar(5, 10, mostrarResultado);
                    </script>
                </div>
            </div>
            <div class="ladoDer">
                <img src="/Imagenes/Screenshot 2025-09-10 110520.png">
            </div>
        </div>
    </div>

    <div class="tarjeta">
        <div class="contenido">
            <div class="ladoIzq">
                <h2 class="titulo">Ejemplo 2</h2>
                <div class="cuerpo">
                    <p>Un callback en JavaScript es una función que se pasa como argumento a otra función y se
                        ejecuta después de que se completa la tarea de la función que la recibió. Los callbacks son
                        una parte fundamental de la programación asíncrona en JavaScript, permitiendo que el
                        código continúe ejecutándose mientras se espera que se completen operaciones como
                        solicitudes de red o temporizadores
                    </p>
                    <p>Ejemplo de un callback simple:</p>
                    <h2>Nombre y Edad</h2>
                    <p>Tiene un retraso de 3 segundos</p>
                    <button id="vnomb">Ver ejemplo</button>
                    <script>
                        // Definimos una función que simula una operación asíncrona
                        function obtenerDatos(callback) {
                            setTimeout(() => {
                                const datos = { nombre: "Juan", edad: 30 };
                                // Llamamos al callback con los datos obtenidos
                                callback(datos);
                            }, 2000); // Simulamos un retraso de 2 segundos
                        }

                        // Definimos un callback que maneja los datos
                        function mostrarDatos(datos) {
                            alert(`Nombre: ${datos.nombre}, Edad: ${datos.edad}`);
                        }

                        const button = document.getElementById('vnomb');
                        button.addEventListener('click', () => {
                            obtenerDatos(mostrarDatos);
                        });
                    </script>
                </div>
            </div>
            <div class="ladoDer">
                <img src="/Imagenes/Screenshot 2025-09-10 112917.png">
            </div>
        </div>
    </div>

    <div class="tarjeta">
        <div class="contenido">
            <div class="ladoIzq">
                <h2 class="titulo">Uso de promesas</h2>
                <div class="cuerpo">
                    <p>Una promesa en JavaScript es un objeto que representa la eventual finalización (o falla) de
                        una operación asíncrona y su valor resultante. Las promesas son una forma de manejar
                        operaciones asíncronas de manera más legible y manejable que los callbacks.
                    </p>
                    <p>Ejemplo</p>
                    <script>
                        // Crear una nueva promesa
                        const miPromesa = new Promise((resolve, reject) => {
                            // Simular una operación asíncrona (por ejemplo, una solicitud de red)
                            const exito = true; // Cambia a false para simular un error
                            if (exito) {
                                resolve("Operación exitosa!"); // Se resuelve la promesa
                            } else {
                                reject("Ocurrió un error."); // Se rechaza la promesa
                            }
                        });
                        // Usar la promesa
                        miPromesa
                            .then((resultado) => {
                                document.write(resultado); // Manejar el resultado si la promesa se resuelve
                            })
                            .catch((error) => {
                                console.error(error); // Manejar el error si la promesa se rechaza
                            });
                    </script>
                </div>
            </div>
            <div class="ladoDer">
                <img src="/Imagenes/Screenshot 2025-09-10 172038.png">
            </div>
        </div>
    </div>

    <div class="tarjeta">
        <div class="contenido">
            <div class="ladoIzq">
                <h2 class="titulo">Ejemplo 2 promesas</h2>
                <div class="cuerpo">
                    <p>Tomando datos de una API de prueba de internet.
                    </p>
                    <p>Ejemplo</p>
                    <button id="promesa">Ver datos</button>
                    <script>
                        function obtenerPosts() {
                            return new Promise((resolve, reject) => {
                                fetch('https://jsonplaceholder.typicode.com/posts')
                                    .then(response => {
                                        if (!response.ok) {
                                            throw new Error('Error en la llamada a la API');
                                        }
                                        return response.json();
                                    })
                                    .then(data => resolve(data))
                                    .catch(error => reject(error));
                            });
                        }
                        const button2 = document.getElementById('promesa');
                        obtenerPosts()
                            .then(posts => {
                                button2.addEventListener('click', () => {
                                    alert(JSON.stringify(posts));
                                });
                            })
                            .catch(error => {
                                button2.addEventListener('click', () => {
                                    alert(JSON.stringify(posts));
                                });
                            });
                    </script>
                </div>
            </div>
            <div class="ladoDer">
                <img src="/Imagenes/Screenshot 2025-09-10 172832.png">
            </div>
        </div>
    </div>

    <div class="tarjeta">
        <div class="contenido">
            <div class="ladoIzq">
                <h2 class="titulo">Simplificando la promesa</h2>
                <div class="cuerpo">
                    <p>Ahora mostramos los post en una lista dinámica en html
                    </p>
                    <h1>Post</h1>
                    <ul id="posts"></ul>
                    <script>
                        // Número máximo de posts a mostrar
                        const sonUnChingo = 5;

                        // Función para obtener los posts desde la API
                        const obtenerPosts1 = () => {
                            fetch('https://jsonplaceholder.typicode.com/posts')
                                .then(response => response.json())
                                .then(data => mostrarPosts1(data))
                                .catch(error => console.log('Error:', error));
                        };

                        // Función para mostrar los posts en el HTML
                        const mostrarPosts1 = (posts) => {
                            const postsUl = document.getElementById('posts');
                            postsUl.innerHTML = ''; // Limpiamos la lista

                            // Mostrar solo los primeros "sonUnChingo" posts
                            posts.slice(0, sonUnChingo).forEach(post => {
                                const li = document.createElement('li');
                                li.textContent = `${post.id}. ${post.title}`;
                                postsUl.appendChild(li);
                            });
                        };

                        // Llamada inicial
                        obtenerPosts1();
                    </script>

                </div>
            </div>
            <div class="ladoDer">
                <img src="/Imagenes/Screenshot 2025-09-10 173432.png">
            </div>
        </div>
    </div>

    <div class="tarjeta">
        <div class="contenido">
            <div class="ladoIzq">
                <h2 class="titulo">Uso de async/await</h2>
                <div class="cuerpo">
                    <p>async y await son palabras clave que permiten escribir código asincrónico de manera
                        más clara y estructurada.
                    <ul>
                        <li>async: Se usa para declarar una función asincrónica</li>
                        <li>await: Se usa dentro de una función asincrónica para esperar el resultado de una
                            promesa</li>
                    </ul>
                    <p>Ejemplo</p>
                    <p>Lista de posts con Async/Await:</p>
                    <ul id="posts2"></ul>

                    <script>
                        // Llamada a la API con Async/Await (SIN recursión)
                        async function llamarApiConAsyncAwait() {
                            try {
                                let datillo = await fetch('https://jsonplaceholder.typicode.com/posts');
                                if (!datillo.ok) {
                                    throw new Error('Error en la llamada a la API');
                                }
                                let posts = await datillo.json();
                                console.log('Posts obtenidos ', posts);
                            } catch (error) {
                                console.log('Error:', error);
                            }
                        }

                        // Obtener posts y mostrarlos en el HTML
                        async function obtenerPostsConAsyncAwait() {
                            try {
                                let response = await fetch('https://jsonplaceholder.typicode.com/posts?_limit=5');
                                if (!response.ok) {
                                    throw new Error('Error en la llamada a la API');
                                }
                                let posts = await response.json();
                                mostrarPosts2(posts); // ✅ Llamamos a una función que apunta a otro <ul>
                            } catch (error) {
                                console.log('Error:', error);
                            }
                        }

                        // Mostrar posts en un <ul> distinto para no chocar con el otro código
                        function mostrarPosts2(posts) {
                            const postsUl = document.getElementById('posts2');
                            postsUl.innerHTML = ''; // limpiar antes de agregar
                            posts.forEach(post => {
                                const li = document.createElement('li');
                                li.textContent = post.title;
                                postsUl.appendChild(li);
                            });
                        }

                        // Llamadas iniciales
                        llamarApiConAsyncAwait();
                        obtenerPostsConAsyncAwait();
                    </script>
                </div>
            </div>
            <div class="ladoDer">
                <img src="/Imagenes/Screenshot 2025-09-16 145632.png">
            </div>
        </div>
    </div>

    <div class="tarjeta">
        <div class="contenido">
            <div class="ladoIzq">
                <h2 class="titulo">Ejercicio: Mostrar Usuarios en una Página Web</h2>
                <div class="cuerpo">
                    <p>El objetivo de este ejercicio es crear una página web que obtenga una lista de usuarios
                        desde una API y muestre sus nombres en una lista.
                    <h1>Usuarios</h1>
                    <ul id="users"></ul>
                    <script src="/Modulos/app.js"></script>
                    </p>
                </div>
            </div>
            <div class="ladoDer">
                <img src="/Imagenes/Screenshot 2025-09-16 150349.png">
            </div>
        </div>
    </div>

    <div class="tarjeta">
        <div class="contenido">
            <div class="ladoIzq">
                <h2 class="titulo">Ejercicio: Personal</h2>
                <div class="cuerpo">
                    <p>Cambiamos los nombres por los emails
                    <h1>Emails</h1>
                    <ul id="users2"></ul>
                    <script src="/Modulos/email.js"></script>
                    </p>
                </div>
            </div>
            <div class="ladoDer">
                <img src="/Imagenes/Screenshot 2025-09-16 151133.png">
            </div>
        </div>
    </div>

    <div class="tarjeta">
        <div class="contenido">
            <div class="ladoIzq">
                <h2 class="titulo">Ejercicio Personal Ejemplo con Promesas</h2>
                <div class="cuerpo">
                    <p>Usamos promesas encadenadas para obtener, procesar y mostrar los usuarios en pantalla.
                    <h2>Lista de Usuarios (Promesas)</h2>
                    <ul id="usersPromise"></ul>
                    <script>
                        // Función para obtener usuarios con Promesas
                        const obtenerUsuariosPromise = () => {
                            fetch('https://jsonplaceholder.typicode.com/users')
                                .then(response => {
                                    if (!response.ok) {
                                        throw new Error('Error en la llamada a la API');
                                    }
                                    return response.json();
                                })
                                .then(users => mostrarUsuariosPromise(users))
                                .catch(error => console.log('Error:', error));
                        };

                        // Función para mostrar usuarios
                        const mostrarUsuariosPromise = (users) => {
                            const usersUl = document.getElementById('usersPromise');
                            usersUl.innerHTML = '';
                            users.slice(0, 5).forEach(user => {
                                const li = document.createElement('li');
                                li.textContent = `${user.name} - ${user.email}`;
                                usersUl.appendChild(li);
                            });
                        };

                        // Llamamos a la función
                        obtenerUsuariosPromise();
                    </script>

                    </p>
                </div>
            </div>
            <div class="ladoDer">
                <img src="/Imagenes/Screenshot 2025-09-16 151406.png">
            </div>
        </div>
    </div>

    <div class="tarjeta">
        <div class="contenido">
            <div class="ladoIzq">
                <h2 class="titulo">Ejercicio: Personal</h2>
                <div class="cuerpo">
                    <p>
                        Hacemos lo mismo que el anterior, pero en vez de encadenar .then(), usa la sintaxis async/await
                        que es más legible y clara.
                    <h2>Lista de Usuarios (Async/Await)</h2>
                    <ul id="usersAsync"></ul>
                    </p>
                </div>
                <script>
                    // Función para obtener usuarios con async/await
                    async function obtenerUsuariosAsync() {
                        try {
                            let response = await fetch('https://jsonplaceholder.typicode.com/users');
                            if (!response.ok) {
                                throw new Error('Error en la llamada a la API');
                            }
                            let users = await response.json();
                            mostrarUsuariosAsync(users);
                        } catch (error) {
                            console.log('Error:', error);
                        }
                    }

                    // Función para mostrar usuarios
                    function mostrarUsuariosAsync(users) {
                        const usersUl = document.getElementById('usersAsync');
                        usersUl.innerHTML = '';
                        users.slice(0, 5).forEach(user => {
                            const li = document.createElement('li');
                            li.textContent = `${user.name} - ${user.email}`;
                            usersUl.appendChild(li);
                        });
                    }

                    // Llamamos a la función
                    obtenerUsuariosAsync();
                </script>
            </div>
            <div class="ladoDer">
                <img src="/Imagenes/Screenshot 2025-09-16 151650.png">
            </div>
        </div>
    </div>
</body>

</html>